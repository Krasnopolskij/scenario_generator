<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ ‚Äî Scenario Generator</title>
  <script>
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ CSS, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å ¬´–º–æ—Ä–≥–∞–Ω–∏—è¬ª
    (function () {
      try {
        var mode = localStorage.getItem('sg:ui:mode');
        if (mode === 'light') {
          document.documentElement.classList.add('light-theme');
        }
      } catch (e) {}
    })();
  </script>
  <style>
    /* –†–∞–Ω–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –º–∏–≥–∞–Ω–∏–µ */
    html.light-theme {
      --bg: #e9edf2;
      --panel: #eef1f4;
      --panel-elev: #fafbfc;
      --text: #111827;
      --muted: #475467;
      --accent: #3b6eea;
      --ok: #2a9d4b;
      --warn: #b98900;
      --error: #d23b3b;
      --surface-soft: #f2f4f7;
      --surface-muted: #e7ebf0;
      --line: #c7cfdb;
      --line-soft: #c0c8d6;
      --bg-start: #e7ebf0;
      --header-bg: var(--panel);
      --nav-active-bg: #e7ebf0;
      --nav-hover-bg: #e7ebf0;
      --nav-active-border: var(--line);
    }
    /* –°–∫—Ä—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –∏ —Ä–∏—Å—É–µ–º –∏–∫–æ–Ω–∫—É —á–µ—Ä–µ–∑ CSS –≤ –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä */
    #theme-toggle { font-size: 0; line-height: 0; }
    #theme-toggle::before { content: '‚òÄ'; font-size: 16px; line-height: 1; }
    html.light-theme #theme-toggle::before { content: 'üåô'; }
  </style>
  <link rel="stylesheet" href="/static/css/style.css?v=20251030-graphfix" />
  <link rel="stylesheet" href="/static/css/light-theme.css?v=20251029" />

</head>
<body class="page-graph">
  <header>
    <h1>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</h1>
    <nav class="nav">
      <button id="open-theme" type="button" class="btn-secondary" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öô</button>
      <button id="theme-toggle" type="button" class="btn-secondary" title="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞" aria-label="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞">‚òÄ</button>
      <a href="/" class="nav-link">–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</a>
      <a href="/cpe" class="nav-link">–í—ã–±–æ—Ä CPE</a>
      <a href="/graph" class="nav-link active">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</a>
    </nav>
  </header>

  <main>
    <section class="controls has-groups">
      <div class="ctrl-group">
        <h2>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π CPE</h2>
        <form id="graph-form" class="form-inline">
        <label for="cpe">URI –æ–±—ä–µ–∫—Ç–∞ –∑–∞—â–∏—Ç—ã:</label>
        <input id="cpe" name="cpe" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, cpe:2.3:a:linkace:linkace:*:*:*:*:*:*:*:*" />
        <select id="mode" name="mode">
          <option value="full" selected>–ü–æ–ª–Ω—ã–π (CVE‚ÜíCWE‚ÜíCAPEC‚ÜíTechnique)</option>
          <option value="simple">–¢–æ–ª—å–∫–æ CVE‚ÜíCPE</option>
        </select>
        <div class="actions">
          <button id="draw-btn" type="submit">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å</button>
          <button id="clear-graph" type="button" title="–û—á–∏—Å—Ç–∏—Ç—å –≥—Ä–∞—Ñ –∏ —Ñ–æ—Ä–º—É">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        </form>
        <p class="hint"></p>
      </div>

      <div class="ctrl-group">
        <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</h2>
        <div class="scenarios-ctrl">
          <div class="field">
            <label for="sc-mode">–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:</label>
            <select id="sc-mode">
              <option value="strict" selected>–°—Ç—Ä–æ–≥–∏–π</option>
              <option value="relaxed">–ù–µ—Å—Ç—Ä–æ–≥–∏–π</option>
            </select>
          </div>
          <div class="field">
            <label for="view-mode">–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
            <select id="view-mode">
              <option value="linear" selected>–õ–∏–Ω–µ–π–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</option>
              <option value="primary">–ü–µ—Ä–≤–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π</option>
            </select>
          </div>
          <div class="field">
            <label for="show-all-cves">
              <input type="checkbox" id="show-all-cves" /> –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ CVE
            </label>
          </div>
          <div class="field">
            <label for="sc-max-per-tactic">–ú–∞–∫—Å–∏–º—É–º —Ç–µ—Ö–Ω–∏–∫ –Ω–∞ —Ç–∞–∫—Ç–∏–∫—É:</label>
            <div class="input-wrap">
              <input id="sc-max-per-tactic" type="number" min="1" max="10" step="1" value="2" />
            </div>
          </div>
          <div class="actions sc-actions">
            <button id="gen-scenarios" type="button">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏</button>
            <button id="clear-scenarios" type="button" title="–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –ø–æ–¥—Å–≤–µ—Ç–∫—É">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
          <div id="scenarios-list" class="scenarios"></div>
        </div>
      </div>
    </section>

    <section>
      <div id="graph"></div>
    </section>

    <aside class="inspector">
      <button id="insp-toggle" class="insp-toggle" type="button" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å" aria-label="–°–≤–µ—Ä–Ω—É—Ç—å –ø–∞–Ω–µ–ª—å"></button>
      <h2>–°–≤–æ–π—Å—Ç–≤–∞ —É–∑–ª–∞</h2>
      <div id="inspector-content" class="kv">
        <div class="row"><div class="k">–ü–æ–¥—Å–∫–∞–∑–∫–∞</div><div class="v">–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ —É–∑–ª—É –Ω–∞ –≥—Ä–∞—Ñ–µ</div></div>
      </div>
    </aside>
  </main>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ -->
  <div id="theme-backdrop" class="modal-backdrop" hidden>
    <div class="modal">
      <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</div>
      <div class="modal-body">
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Ö–æ–ª—Å—Ç–∞</label>
          <input id="theme-canvas" type="color" value="#0f1326" />
        </div>
        <div class="theme-row">
          <label>–¶–≤–µ—Ç –Ω–∞–¥–ø–∏—Å–µ–π (label)</label>
          <input id="theme-label" type="color" value="#e5e7ef" />
        </div>
        <hr style="border:0;border-top:1px solid #1d2342;margin:10px 0">
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —É–∑–ª–æ–≤ CPE</label>
          <input id="theme-node-cpe" type="color" value="#8e44ad" />
        </div>
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —É–∑–ª–æ–≤ CVE</label>
          <input id="theme-node-cve" type="color" value="#e74c3c" />
        </div>
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —É–∑–ª–æ–≤ CWE</label>
          <input id="theme-node-cwe" type="color" value="#e49659" />
        </div>
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —É–∑–ª–æ–≤ CAPEC</label>
          <input id="theme-node-capec" type="color" value="#3498db" />
        </div>
        <div class="theme-row">
          <label>–¶–≤–µ—Ç —É–∑–ª–æ–≤ Technique</label>
          <input id="theme-node-tech" type="color" value="#4fca21" />
        </div>
        <hr style="border:0;border-top:1px solid #1d2342;margin:10px 0">
        <div class="theme-row">
          <label>–°–≤—è–∑—å AFFECTS</label>
          <input id="theme-edge-AFFECTS" type="color" value="#c0392b" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å CWE_TO_CVE</label>
          <input id="theme-edge-CWE_TO_CVE" type="color" value="#d35400" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å CAPEC_TO_CWE</label>
          <input id="theme-edge-CAPEC_TO_CWE" type="color" value="#2980b9" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å CAPEC_PARENT_TO_CAPEC_CHILD</label>
          <input id="theme-edge-CAPEC_PARENT_TO_CAPEC_CHILD" type="color" value="#7f8c8d" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å CAPEC_TO_TECHNIQUE</label>
          <input id="theme-edge-CAPEC_TO_TECHNIQUE" type="color" value="#27ae60" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å SC_STEP</label>
          <input id="theme-edge-SC_STEP" type="color" value="#7f8c8d" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å SC_TECH_TO_CVE</label>
          <input id="theme-edge-SC_TECH_TO_CVE" type="color" value="#8e44ad" />
        </div>
        <div class="theme-row">
          <label>–°–≤—è–∑—å SC_GROUP</label>
          <input id="theme-edge-SC_GROUP" type="color" value="#7f8c8d" />
        </div>
      </div>
      <div class="modal-actions">
        <button id="theme-reset" class="btn-secondary" title="–°–±—Ä–æ—Å–∏—Ç—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Ü–≤–µ—Ç–∞–º">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <span style="flex:1"></span>
        <button id="theme-cancel" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
        <button id="theme-apply" class="btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <footer>
    <span></span>
  </footer>

  <!-- –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Cytoscape -->
  <script src="/static/js/vendor/cytoscape.js-3.33.1/dist/cytoscape.min.js"></script>
  <script src="/static/js/theme.js?v=20251030" defer></script>
  <script src="/static/js/graph.js?v=20251027-7"></script>
</body>
</html>
